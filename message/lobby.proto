syntax = "proto3";

enum State {
    UNDEFINED = 0;
    STOPPED = 1;
    STARTED = 2;
    UNUSED = 3;
    LAUNCHED = 4;
}

enum KickReason {
    UNDEFINED = 0;
    MAX_PLAYERS = 1;
    WRONG_PASSWORD = 2;
    MAKER_DECISION = 3;
    UNUSED = 4;
    STARTED = 5;
    OLD_VERSION = 6;
}

message LobbyRequestMessage {
    optional JoinRequest join_request = 1;
    optional PickRequest pick_request = 2;
    optional bool leave_request = 3;
    optional ChatRequest chat_request = 4;
    message JoinRequest {
        string name = 1;
        optional string password = 2;
        optional uint32 version = 3;
    }
    message ChatRequest {
        string message = 1;
    }
}

message LobbyNotificationMessage {
    optional State switch_state_request = 1;
    optional LaunchRequest launch_request = 2;
    message LaunchRequest {
        fixed64 ip = 1; //127.0.0.1
        uint32 port = 2; // 5119
        bytes key = 3; //17BLOhi6KZsTtldTsizvHg==
        uint32 client_id = 4; // 1
        optional float delay = 5;
    }
    repeated PeerRequests peers_requests = 3;
    message PeerRequests {
        uint32 player_id = 1;
        optional bool leave_request = 2;
        optional JoinRequest join_request = 3;
        optional PickRequest pick_request = 4;
        optional ChatRequest chat_request = 5;
    }
    message JoinRequest {
        string name = 1;
        optional bool is_me = 2;
        optional PeerInfo info = 3;
        message PeerInfo {
            bytes public_key = 1;
            repeated bytes addrs = 2;
        }
    }
    message ChatRequest {
        string message = 1;
    }
    optional KickReason kick_request = 4;
}

message PickRequest {
    optional uint32 team = 1;
    optional uint32 champion = 2;
    optional uint32 spell1 = 3;
    optional uint32 spell2 = 4;
    optional uint32 lock = 5;
    optional uint32 difficulty = 6;
    optional uint32 skin = 7;
    map<uint32, uint32> talents = 8;
    optional bool server_started = 9;
    optional float max_ping_observed = 10;
}
